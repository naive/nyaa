#!/usr/bin/env ruby

require 'rubygems' # for ruby 1.8
require './lib/nyaa' # for testing

opts = Nyaa::CLI.parse(ARGV)

if opts[:batch]
  # Batch mode
  # TODO: This needs a proper implementation
  nyaa = Nyaa::Search.new(opts[:query], opts[:category], opts[:filter])
  results = nyaa.more.get_results
  results.each do |r|
    puts "o #{r.name}"
    puts "#{r.link}"
    puts
  end
  exit
end

begin
  nyaa = Nyaa::Browser.new(opts)
rescue Interrupt
  puts "\nInterrupt received. Exiting."
  exit
end
